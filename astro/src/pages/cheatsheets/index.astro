---
import { getCollection } from "astro:content";
import LandingPageLayout from "@layouts/LandingPage.astro";
import BlogPagination from "@components/ui/nav/BlogPagination.astro";
import GlowLineSeparator from "@components/ui/separator/GlowLineSeparator.astro";
import HeroSection from "@components/sections/HeroSection.astro";
import CheatSheetList from "@components/sections/CheatSheetList.astro";
import Pagination from "@components/ui/nav/Pagination.astro";

const title = "Cheat Sheets!";
const allPosts = await getCollection("cheatsheets");
const categories = [
  ...new Set(allPosts.map((post) => post.data.categories).flat()),
];
const tags = [...new Set(allPosts.map((post) => post.data.tags).flat())];

const PAGE_SIZE = 6;
const posts = (await getCollection("cheatsheets")).sort(
  (a, b) => +b.data.pubDate - +a.data.pubDate,
);
const sheets = posts.slice(0, PAGE_SIZE);
const totalPages = Math.max(1, Math.ceil(posts.length / PAGE_SIZE));
---

<LandingPageLayout {title}>
  <HeroSection
    {title}
    subtitle="This is where I will post about my journey learning Astro."
  />
  <CheatSheetList sheets={sheets} />
  <Pagination
    currentPage={1}
    totalPages={totalPages}
    rootPath="/cheatsheets/"
    basePath="/cheatsheets/page"
    prevLabel="← Back"
    nextLabel="Next →"
  />

  <GlowLineSeparator />
</LandingPageLayout>
