<!-- Cards Grid -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" x-data="getData('projects')">
  <template x-for="project in filtered('tools')" :key="project.path">
    <div class="bg-white shadow rounded overflow-hidden hover:shadow-lg transition">
      <a :href="`../${project.path}`" class="block">
        <img :src="project.image" alt="" class="w-full h-40 object-cover" />
        <div class="p-4">
          <h3 class="text-lg font-semibold" x-text="project.title"></h3>
          <p class="text-sm text-gray-600 mt-1" x-text="project.description"></p>
        </div>
      </a>
    </div>
  </template>
</div>

<script>
  function getData(sheet = 'projects') {
    return {
      items: [],
      loading: true,

      async init() {
        const cacheKey = `items-cache-${sheet}`;
        const cached = sessionStorage.getItem(cacheKey);

        if (cached) {
          this.items = JSON.parse(cached);
          this.loading = false;
          return;
        }

        try {
          const response = await fetch(`/api/data?sheet=${sheet}`);
          const data = await response.json();
          this.items = data;
          sessionStorage.setItem(cacheKey, JSON.stringify(data));
        } catch (error) {
          console.error('Error loading data:', error);
        } finally {
          this.loading = false;
        }
      },

      get groups() {
        return this.items.filter(p => p.category === 'group');
      },

      get categories() {
        return [...new Set(this.items.map(p => p.category))];
      },

      filtered(category) {
        return this.items.filter(p => p.category === category && p.shown);
      },
    };
  }
</script>